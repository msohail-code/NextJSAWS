{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Sohail/Desktop/office/client-master/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/Sohail/Desktop/office/client-master/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Sohail\\\\Desktop\\\\office\\\\client-master\\\\src\\\\components\\\\login.js\",\n    _s = $RefreshSig$();\n\nimport Head from \"next/head\";\nimport { Fragment, useState } from \"react\";\nimport axios from \"axios\";\nimport { toast, ToastContainer } from 'react-nextjs-toast';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useRouter } from 'next/router';\nexport default function Login() {\n  _s();\n\n  var dispatch = useDispatch();\n\n  var _useState = useState(false),\n      isLoggingIn = _useState[0],\n      setIsLoggingIn = _useState[1];\n\n  var _useState2 = useState(false),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var _useState3 = useState(false),\n      otpSent = _useState3[0],\n      setOtpSent = _useState3[1];\n\n  var _useState4 = useState(false),\n      verifyingOtp = _useState4[0],\n      setVerifyingOtp = _useState4[1];\n\n  var _useState5 = useState(null),\n      email = _useState5[0],\n      setEmail = _useState5[1];\n\n  var _useState6 = useState(true),\n      showLoginPage = _useState6[0],\n      setShowLoginPage = _useState6[1];\n\n  var router = useRouter();\n  var redirect = router.query.redirect || null;\n  var cartId = useSelector(function (state) {\n    return state.config.cartId ? state.config.cartId : null;\n  });\n\n  var login = function login(e) {\n    e.preventDefault();\n    setIsLoggingIn(true);\n    axios.post(\"\".concat(process.env.API_URL, \"user/login\"), {\n      email: e.target.email.value,\n      password: e.target.password.value\n    }).then(function (res) {\n      setIsLoggingIn(false);\n      dispatch({\n        type: \"USER_LOGIN\",\n        payload: res.data\n      });\n      redirect && router.push(redirect);\n    })[\"catch\"]( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(err) {\n        var statusCode;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                setIsLoggingIn(false);\n                statusCode = err.response.data.statusCode || null;\n\n                if (!(statusCode === 1100)) {\n                  _context.next = 10;\n                  break;\n                }\n\n                _context.next = 5;\n                return resendOtp();\n\n              case 5:\n                setEmail(e.target.email.value);\n                setOtpSent(true);\n                setShowLoginPage(false);\n                _context.next = 11;\n                break;\n\n              case 10:\n                toast.notify(err.response.data.message, {\n                  type: \"error\",\n                  title: \"Login Error!\"\n                });\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  };\n\n  function resendOtp() {\n    return _resendOtp.apply(this, arguments);\n  }\n\n  function _resendOtp() {\n    _resendOtp = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return axios.post(\"\".concat(process.env.API_URL, \"customer/resendOtp\"), {\n                email: email\n              });\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _resendOtp.apply(this, arguments);\n  }\n\n  var onSubmit = function onSubmit(e) {\n    e.preventDefault();\n    var name = e.target.name.value;\n    var email = e.target.email.value;\n    var password = e.target.password.value;\n    var confirmPassword = e.target.confirmPassword.value;\n    var phone = e.target.phone.value;\n    setEmail(email);\n\n    if (confirmPassword !== password) {\n      toast.notify(\"Password and confirm password does not match!\", {\n        type: \"error\",\n        title: \"Error!\"\n      });\n      return false;\n    }\n\n    setIsLoading(true);\n    axios.post(\"\".concat(process.env.API_URL, \"customer/registartion\"), {\n      name: name,\n      email: email,\n      password: password,\n      phone: phone\n    }).then(function (response) {\n      toast.notify(\"An OTP sent at your email address!\", {\n        type: \"success\",\n        title: \"OTP Sent!\"\n      });\n      setOtpSent(true);\n    })[\"catch\"](function (err) {\n      var message = err.response.data.errors ? err.response.data.errors[0].message : \"Oops! something went wrong!\";\n      toast.notify(message, {\n        type: \"error\",\n        title: \"OTP Error!\"\n      });\n      setIsLoading(false);\n    });\n  };\n\n  var verifyOtp = function verifyOtp(e) {\n    e.preventDefault();\n    setVerifyingOtp(true);\n    axios.post(\"\".concat(process.env.API_URL, \"customer/verify\"), {\n      otp: e.target.otp.value,\n      email: email\n    }).then(function (res) {\n      setVerifyingOtp(false);\n      toast.notify(\"OTP Verified! Please login\", {\n        type: \"success\",\n        title: \"OTP!\"\n      });\n      setShowLoginPage(true);\n    })[\"catch\"](function (err) {\n      toast.notify(err.response.data.message, {\n        type: \"error\",\n        title: \"OTP Error!\"\n      });\n      setVerifyingOtp(false);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Login - Gandhi\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ToastContainer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }, this), showLoginPage ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid ld_bg\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inner_main_ld\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Welcome to Gandhi Fabrics\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            className: \"loginForm\",\n            onSubmit: login,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form_login\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"email\",\n                name: \"email\",\n                placeholder: \"Email Address\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"password\",\n                name: \"password\",\n                placeholder: \"Password\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 126,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"textBtn ml-0\",\n                onClick: function onClick() {\n                  return router.push(\"/forgotPassword\");\n                },\n                children: \"Forgot Password?\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 45\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"login_bttn go_bttn\",\n              disabled: isLoggingIn,\n              children: isLoggingIn ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"loader\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 130,\n                columnNumber: 61\n              }, this) : \"LOG IN\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mass_tx\",\n              style: {\n                textAlign: \"center\"\n              },\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"textBtn\",\n                onClick: function onClick() {\n                  setShowLoginPage(false);\n                  setOtpSent(false);\n                },\n                children: \"Don't have an account? Sign up\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 133,\n                columnNumber: 45\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 37\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 33\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 29\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 25\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid ld_bg\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inner_main_ld\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Welcome to Gandhi Fabrics\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 37\n          }, this), !otpSent ? /*#__PURE__*/_jsxDEV(\"form\", {\n            className: \"loginForm\",\n            onSubmit: onSubmit,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form_login\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                name: \"name\",\n                placeholder: \"Name\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 53\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                name: \"phone\",\n                placeholder: \"Mobile number\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 53\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                name: \"email\",\n                placeholder: \"Email address\",\n                type: \"email\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 53\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"password\",\n                name: \"password\",\n                placeholder: \"Password\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 53\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"password\",\n                name: \"confirmPassword\",\n                placeholder: \"Confirm password\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 53\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 49\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"login_bttn go_bttn\",\n              disabled: isLoading,\n              children: isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"loader\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 66\n              }, this) : \"SIGN UP\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 49\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mass_tx\",\n              style: {\n                textAlign: \"center\"\n              },\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"textBtn\",\n                type: \"button\",\n                onClick: function onClick() {\n                  return setShowLoginPage(true);\n                },\n                children: \"Already have an account? Login\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 53\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 49\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 45\n          }, this) : /*#__PURE__*/_jsxDEV(\"form\", {\n            className: \"loginForm\",\n            onSubmit: verifyOtp,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form_login\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  name: \"otp\",\n                  \"aria-label\": \"Otp\",\n                  placeholder: \"OTP\",\n                  type: \"text\",\n                  required: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 165,\n                  columnNumber: 57\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 164,\n                columnNumber: 53\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 163,\n              columnNumber: 49\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"login_bttn go_bttn\",\n              disabled: verifyingOtp,\n              children: verifyingOtp ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"loader\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 69\n              }, this) : \"VERIFY\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 49\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mass_tx\",\n              style: {\n                textAlign: \"center\"\n              },\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"textBtn\",\n                onClick: function onClick() {\n                  return setShowLoginPage(true);\n                },\n                children: \"Already have an account? Login\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 172,\n                columnNumber: 53\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 49\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 45\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 33\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 29\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 25\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Login, \"+9uQvHVtVYSkPHrDWaDHttZd+Ek=\", false, function () {\n  return [useDispatch, useRouter, useSelector];\n});\n\n_c = Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["C:/Users/Sohail/Desktop/office/client-master/src/components/login.js"],"names":["Head","Fragment","useState","axios","toast","ToastContainer","useDispatch","useSelector","useRouter","Login","dispatch","isLoggingIn","setIsLoggingIn","isLoading","setIsLoading","otpSent","setOtpSent","verifyingOtp","setVerifyingOtp","email","setEmail","showLoginPage","setShowLoginPage","router","redirect","query","cartId","state","config","login","e","preventDefault","post","process","env","API_URL","target","value","password","then","res","type","payload","data","push","err","statusCode","response","resendOtp","notify","message","title","onSubmit","name","confirmPassword","phone","errors","verifyOtp","otp","textAlign"],"mappings":"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","sourcesContent":["import Head from \"next/head\";\nimport { Fragment, useState } from \"react\";\nimport axios from \"axios\"\nimport { toast, ToastContainer } from 'react-nextjs-toast'\nimport { useDispatch, useSelector } from \"react-redux\"\nimport { useRouter } from 'next/router'\n\nexport default function Login() {\n    const dispatch = useDispatch()\n    const [isLoggingIn, setIsLoggingIn] = useState(false)\n    const [isLoading, setIsLoading] = useState(false)\n    const [otpSent, setOtpSent] = useState(false)\n    const [verifyingOtp, setVerifyingOtp] = useState(false)\n    const [email, setEmail] = useState(null)\n    const [showLoginPage, setShowLoginPage] = useState(true)\n    const router = useRouter()\n    const redirect = router.query.redirect || null;\n    let cartId = useSelector(state => state.config.cartId ? state.config.cartId : null);\n\n    const login = (e) => {\n        e.preventDefault()\n        setIsLoggingIn(true)\n\n        axios.post(`${process.env.API_URL}user/login`, { email: e.target.email.value, password: e.target.password.value }).then(res => {\n            setIsLoggingIn(false)\n            dispatch({ type: \"USER_LOGIN\", payload: res.data });\n            redirect && router.push(redirect);\n        }).catch(async (err) => {\n            setIsLoggingIn(false);\n            let statusCode = err.response.data.statusCode || null;\n            if (statusCode === 1100) {\n                await resendOtp();\n                setEmail(e.target.email.value);\n                setOtpSent(true);\n                setShowLoginPage(false);\n            } else {\n                toast.notify(err.response.data.message, {\n                    type: \"error\",\n                    title: \"Login Error!\"\n                });\n            }\n        })\n    }\n\n    async function resendOtp() {\n        await axios.post(`${process.env.API_URL}customer/resendOtp`, { email: email });\n    }\n\n    const onSubmit = (e) => {\n        e.preventDefault()\n        let name = e.target.name.value\n        let email = e.target.email.value\n        let password = e.target.password.value\n        let confirmPassword = e.target.confirmPassword.value\n        let phone = e.target.phone.value\n\n        setEmail(email)\n\n        if (confirmPassword !== password) {\n            toast.notify(\"Password and confirm password does not match!\", {\n                type: \"error\",\n                title: \"Error!\"\n            })\n            return false\n        }\n\n        setIsLoading(true)\n        axios.post(`${process.env.API_URL}customer/registartion`, {\n            name: name,\n            email: email,\n            password: password,\n            phone: phone\n        }).then((response) => {\n            toast.notify(\"An OTP sent at your email address!\", {\n                type: \"success\",\n                title: \"OTP Sent!\"\n            })\n            setOtpSent(true)\n        }).catch(err => {\n            let message = err.response.data.errors ? err.response.data.errors[0].message : \"Oops! something went wrong!\"\n            toast.notify(message, {\n                type: \"error\",\n                title: \"OTP Error!\"\n            })\n            setIsLoading(false)\n        })\n\n    }\n\n    const verifyOtp = (e) => {\n        e.preventDefault()\n\n        setVerifyingOtp(true)\n        axios.post(`${process.env.API_URL}customer/verify`, { otp: e.target.otp.value, email: email }).then(res => {\n            setVerifyingOtp(false)\n            toast.notify(\"OTP Verified! Please login\", {\n                type: \"success\",\n                title: \"OTP!\"\n            })\n            setShowLoginPage(true)\n        }).catch(err => {\n            toast.notify(err.response.data.message, {\n                type: \"error\",\n                title: \"OTP Error!\"\n            })\n            setVerifyingOtp(false)\n        })\n    }\n\n    return (\n        <Fragment>\n            <Head>\n                <title>Login - Gandhi</title>\n            </Head>\n            <ToastContainer />\n            {\n                showLoginPage ?\n                    (\n                        <div className=\"container-fluid ld_bg\">\n                            <div className=\"row\">\n                                <div className=\"inner_main_ld\">\n                                    <h4>Welcome to Gandhi Fabrics</h4>\n                                    <form className=\"loginForm\" onSubmit={login}>\n                                        <div className=\"form_login\">\n                                            <input type=\"email\" name=\"email\" placeholder=\"Email Address\" required={true} />\n                                            <input type=\"password\" name=\"password\" placeholder=\"Password\" required={true} />\n                                            <button type=\"button\" className=\"textBtn ml-0\" onClick={() => router.push(\"/forgotPassword\")}>Forgot Password?</button>\n                                        </div>\n                                        <button type=\"submit\" className=\"login_bttn go_bttn\" disabled={isLoggingIn}>\n                                            {isLoggingIn ? (<div className=\"loader\"></div>) : \"LOG IN\"}\n                                        </button>\n                                        <p className=\"mass_tx\" style={{ textAlign: \"center\" }}>\n                                            <button type=\"button\" className=\"textBtn\" onClick={() => { setShowLoginPage(false); setOtpSent(false) }}>Don't have an account? Sign up</button>\n                                        </p>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    ) : (\n                        <div className=\"container-fluid ld_bg\">\n                            <div className=\"row\">\n                                <div className=\"inner_main_ld\">\n                                    <h4>Welcome to Gandhi Fabrics</h4>\n                                    {\n                                        !otpSent ? (\n                                            <form className=\"loginForm\" onSubmit={onSubmit} >\n                                                <div className=\"form_login\">\n                                                    <input type=\"text\" name=\"name\" placeholder=\"Name\" required />\n                                                    <input type=\"text\" name=\"phone\" placeholder=\"Mobile number\" required />\n                                                    <input name=\"email\" placeholder=\"Email address\" type=\"email\" required />\n                                                    <input type=\"password\" name=\"password\" placeholder=\"Password\" required />\n                                                    <input type=\"password\" name=\"confirmPassword\" placeholder=\"Confirm password\" required />\n                                                </div>\n                                                <button type=\"submit\" className=\"login_bttn go_bttn\" disabled={isLoading}>{\n                                                    isLoading ? (<div className=\"loader\"></div>) : \"SIGN UP\"\n                                                }</button>\n                                                <p className=\"mass_tx\" style={{ textAlign: \"center\" }}>\n                                                    <button className=\"textBtn\" type=\"button\" onClick={() => setShowLoginPage(true)}>Already have an account? Login</button>\n                                                </p>\n                                            </form>\n                                        ) : (\n                                            <form className=\"loginForm\" onSubmit={verifyOtp}>\n                                                <div className=\"form_login\">\n                                                    <div>\n                                                        <input name=\"otp\" aria-label=\"Otp\" placeholder=\"OTP\" type=\"text\" required />\n                                                    </div>\n                                                </div>\n                                                <button type=\"submit\" className=\"login_bttn go_bttn\" disabled={verifyingOtp}>{\n                                                    verifyingOtp ? (<div className=\"loader\"></div>) : \"VERIFY\"\n                                                }</button>\n                                                <p className=\"mass_tx\" style={{ textAlign: \"center\" }}>\n                                                    <button type=\"button\" className=\"textBtn\" onClick={() => setShowLoginPage(true)}>Already have an account? Login</button>\n                                                </p>\n                                            </form>\n                                        )\n                                    }\n\n                                </div>\n                            </div>\n                        </div>\n                    )\n            }\n\n        </Fragment>\n    )\n}"]},"metadata":{},"sourceType":"module"}